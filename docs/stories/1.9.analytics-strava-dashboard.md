---
rationale: Analytics page implementation - Strava-inspired performance dashboard showing work patterns, project segments, weekly volume, time patterns, and strategic insights. Built on enriched session data from Story 1.8 (time-boxing enhancements).
version: 1.0.0
changelog:
  - 1.0.0: Initial scaffold with Strava-inspired analytics vision and component architecture
links:
  - docs/brief.md: Vision for "Strava of Project Management" with performance analytics
  - docs/stories/1.8.deepfocus-timebox-enhancements.md: Session data foundation (goals, completion, daily intentions)
  - docs/stories/1.7.analytics-implementation.md: Original analytics plan (deferred)
---

# Analytics Strava Dashboard - Story 1.9

## Status
ğŸ“‹ **PLANNING** - Awaiting Story 1.8 completion

## Vision

**The Strava of Project Management** - Transform session data into compelling performance intelligence. Like Strava reveals running patterns (pace, routes, consistency), Eugene Strat reveals work patterns: capacity, focus quality, strategic alignment, and productivity trends.

## Core Philosophy

- **Actionable insights** over vanity metrics
- **Pattern recognition** to improve performance
- **14-day focus** (Strava's sweet spot for actionable trends)
- **Project segments** showing time investment per "route"
- **Strava-style activity feed** for recent sessions

## Scope

### 1. Hero Metrics Bar (Top)
**Quick stats at a glance**
- This Week: Total hours, session count, XP earned, current streak
- Horizontal strip, bold numbers
- Color: Dark purple #451969 background, white text

### 2. Recent Sessions Feed (Strava Activity Feed)
**Last 7 days of completed sessions as cards**
- Each card shows: time/date, project name, duration, goal status (âœ“âš ï¸âœ—), mindset quality, XP earned
- Click to expand and see session notes
- Color-coded mindset badges: Shaolin=green, Getting There=yellow, What Zone=red
- Design: Cream cards, 2px black borders, stacked vertically

### 3. Project Segments (Core Strava Concept)
**Each tracked project as a "segment" with performance metrics**
- Total hours invested per project
- Session count on that project
- Average session duration
- Focus quality trend (% high mindset sessions)
- Like Strava segments: see all your "efforts" on each project-route
- Sortable by: time invested, session count, recency
- Design: Table or card grid, purple accents

### 4. Weekly Volume Chart
**Bar chart showing daily capacity patterns**
- Hours per day for last 14 days
- Shows: Can you sustain 4+ hours daily? Weekly peaks?
- Helps plan realistic time-boxing commitments
- Design: Simple bar chart, dark green bars, black axes

### 5. Time-of-Day Heatmap
**When do you work best?**
- Grid: hour blocks (rows) Ã— days of week (columns)
- Color intensity = session frequency
- Reveals peak focus windows for better scheduling
- Design: GitHub-style heatmap, purple gradient

### 6. Focus Quality Trends
**Mindset patterns over time**
- Line or area chart showing high/medium/low mindset distribution
- 2-4 week view: Are you improving? Burning out? Staying consistent?
- Weekly breakdown: Shaolin/Getting There/What Zone session counts
- Design: Smooth line chart, color-coded by mindset level

### 7. Strategic Alignment Analysis (Enhanced Completion Scatter)
**Did high-value projects get adequate time?**
- Cost/Benefit scatter plot (mirrors TacticalMap)
- **Key innovation**: Dot size = hours invested on that project
- Shows misalignment: low-benefit projects consuming lots of time
- Completed projects only
- Design: 10Ã—10 grid, purple dots with size variation

### 8. Personal Records (Strava-Style PRs)
**Best performances with dates**
- Best Day (most hours/sessions)
- Best Week (highest XP)
- Longest Session (minutes)
- Longest Streak (consecutive days)
- Design: 2Ã—2 grid, pink accent cards, trophy icons

### 9. Achievements (Optional Gamification)
**Milestone badges**
- Unlocked: Quote + description + date earned
- Locked: Mystery state (not revealed)
- From brief.md achievement definitions
- Design: Badge grid, black/white neo-brutalist

## Color System (Analytics Neo-Brutalism)

**Primary Palette:**
- Dark Purple #451969 (authority, strategic depth)
- Pink #E5B6E5 (achievement, energy bursts)
- Cream #F5F5DC (data clarity, backgrounds)
- Black #000000 (structure, borders)
- White #FFFFFF (contrast, text)

**Design Principles:**
- 2-3px black borders on components
- 4px hard shadows (no blur)
- No rounded corners
- High contrast for accessibility
- Professional restraint (not overwhelming)

## Database Queries Required

### Query 1: Weekly Stats
```sql
SELECT
  COUNT(*) as sessions,
  SUM(duration) / 60.0 as total_hours,
  SUM(xp_earned) as total_xp
FROM sessions
WHERE user_id = ? AND is_completed = true
  AND started_at >= NOW() - INTERVAL '7 days'
```

### Query 2: Recent Sessions Feed
```sql
SELECT
  s.id, s.started_at, s.duration, s.session_goal,
  s.goal_completed, s.mindset, s.xp_earned,
  p.name as project_name
FROM sessions s
JOIN projects p ON p.id = s.project_id
WHERE s.user_id = ? AND s.is_completed = true
ORDER BY s.started_at DESC
LIMIT 7
```

### Query 3: Project Segments
```sql
SELECT
  p.id, p.name,
  COUNT(s.id) as session_count,
  SUM(s.duration) / 60.0 as total_hours,
  AVG(s.duration) as avg_duration,
  COUNT(*) FILTER (WHERE s.mindset = 'high') * 100.0 / COUNT(*) as high_mindset_pct
FROM projects p
LEFT JOIN sessions s ON s.project_id = p.id AND s.is_completed = true
WHERE p.user_id = ?
GROUP BY p.id, p.name
HAVING COUNT(s.id) > 0
ORDER BY total_hours DESC
```

### Query 4: Weekly Volume (14 days)
```sql
SELECT
  DATE(started_at) as date,
  SUM(duration) / 60.0 as hours
FROM sessions
WHERE user_id = ? AND is_completed = true
  AND started_at >= NOW() - INTERVAL '14 days'
GROUP BY DATE(started_at)
ORDER BY date
```

### Query 5: Time-of-Day Heatmap
```sql
SELECT
  EXTRACT(DOW FROM started_at) as day_of_week,
  EXTRACT(HOUR FROM started_at) as hour,
  COUNT(*) as session_count
FROM sessions
WHERE user_id = ? AND is_completed = true
  AND started_at >= NOW() - INTERVAL '30 days'
GROUP BY day_of_week, hour
```

### Query 6: Strategic Alignment (Completed Projects with Time)
```sql
SELECT
  p.cost, p.benefit, p.name,
  COALESCE(SUM(s.duration) / 60.0, 0) as hours_invested
FROM projects p
LEFT JOIN sessions s ON s.project_id = p.id AND s.is_completed = true
WHERE p.user_id = ? AND p.status = 'completed'
GROUP BY p.id, p.cost, p.benefit, p.name
```

### Query 7: Personal Records
```sql
-- Best day
SELECT DATE(started_at) as date, COUNT(*) as sessions
FROM sessions
WHERE user_id = ? AND is_completed = true
GROUP BY DATE(started_at)
ORDER BY sessions DESC
LIMIT 1

-- Best week
SELECT DATE_TRUNC('week', started_at) as week, SUM(xp_earned) as xp
FROM sessions
WHERE user_id = ? AND is_completed = true
GROUP BY week
ORDER BY xp DESC
LIMIT 1

-- Longest session
SELECT duration, started_at
FROM sessions
WHERE user_id = ? AND is_completed = true
ORDER BY duration DESC
LIMIT 1

-- Longest streak (requires streak calculation logic)
```

## Component Architecture

```
src/components/analytics/
â”œâ”€â”€ HeroMetricsBar.tsx          # Weekly stats strip
â”œâ”€â”€ SessionsFeed.tsx             # Recent activity cards
â”œâ”€â”€ SessionCard.tsx              # Individual session card
â”œâ”€â”€ ProjectSegments.tsx          # Project performance table
â”œâ”€â”€ WeeklyVolumeChart.tsx        # Bar chart (14 days)
â”œâ”€â”€ TimeOfDayHeatmap.tsx         # Hour Ã— day grid
â”œâ”€â”€ FocusQualityTrends.tsx       # Line chart (mindset)
â”œâ”€â”€ StrategicAlignmentScatter.tsx # Cost/benefit with size
â”œâ”€â”€ PersonalRecords.tsx          # 2Ã—2 PR cards
â”œâ”€â”€ AchievementBadges.tsx        # Optional gamification
â””â”€â”€ types.ts                     # Analytics-specific types
```

## Page Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header (Universal)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Hero Metrics Bar (Sessions | Hours | XP | Streak)â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ LEFT (60%)           â”‚ RIGHT (40%)          â”‚ â”‚
â”‚ â”‚                      â”‚                      â”‚ â”‚
â”‚ â”‚ Sessions Feed        â”‚ Project Segments     â”‚ â”‚
â”‚ â”‚ (Last 7 days)        â”‚ (Time per project)   â”‚ â”‚
â”‚ â”‚                      â”‚                      â”‚ â”‚
â”‚ â”‚                      â”‚                      â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚ â”‚
â”‚ â”‚ Weekly Volume Chart  â”‚                      â”‚ â”‚
â”‚ â”‚ (14-day bars)        â”‚                      â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Time-of-Day Heatmap                          â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Focus Quality Trends â”‚ Strategic Alignment  â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Personal Records     â”‚ Achievements         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Implementation Notes

### Prerequisites
- **Story 1.8 must be complete** - Requires session_goal, goal_completed, session_notes fields
- Sessions table has mindset, duration, xp_earned, started_at
- Projects table has cost, benefit, status

### Data Fetching Strategy
- Server-side initial load for hero metrics + recent sessions
- Client-side lazy loading for charts (progressive enhancement)
- Cache-first approach for historical data (rarely changes)

### Performance Targets
- Initial page load: <200ms
- Chart rendering: <100ms each
- Smooth scrolling with all components visible

### Phased Implementation
**Phase 1** (Core analytics):
1. Hero metrics bar
2. Sessions feed
3. Project segments
4. Weekly volume chart

**Phase 2** (Advanced insights):
5. Time-of-day heatmap
6. Focus quality trends
7. Strategic alignment scatter

**Phase 3** (Polish):
8. Personal records
9. Achievements
10. Responsive refinements

## Success Criteria

1. âœ… Users see their work patterns at a glance
2. âœ… Session feed updates after completing sessions
3. âœ… Project segments reveal time allocation
4. âœ… Weekly volume shows capacity trends
5. âœ… Heatmap identifies peak focus times
6. âœ… Strategic alignment reveals priority mismatches
7. âœ… Personal records motivate continued effort
8. âœ… Page loads fast (<200ms) with smooth interactions
9. âœ… Neo-brutalist design consistent throughout
10. âœ… All data visualizations accessible (WCAG AA)

## Open Questions for Implementation

1. **Charting library**: Recharts vs custom SVG vs Canvas?
2. **Real-time updates**: WebSocket for live session completion or manual refresh?
3. **Mobile layout**: Single column stack or defer mobile optimization?
4. **Data retention**: Show all-time data or limit to last 90 days?
5. **Empty states**: How to handle new users with no session data?

## Future Enhancements (Post-Validation)

- Export data as CSV
- Custom date range filters
- Compare weeks/months
- Goal completion analytics
- Project category breakdowns
- Weekly email summaries (Strava-style)

---

**This story represents the culmination of the "Strava for Project Management" vision - transforming raw time-boxing data into actionable performance intelligence.**
