---
rationale: Analytics page implementation - Refined professional productivity dashboard with strategic insights, single-screen experience, and sophisticated neo-brutalist design
version: 0.2.0
changelog:
  - 0.2.0: UX REFINEMENT - Reduced to 4 core visualizations for single-screen experience, softened neo-brutalist elements, emphasized strategic completion analysis, professional restraint over gamification
  - 0.1.0: Initial comprehensive specification with purple-pink color system, creative visualizations (treemap, radial, bubbles), and 2-week focus approach
links:
  - docs/stories/1.6.deepfocus-implementation.md: Previous story with completed deep focus session tracking
  - docs/brief.md: Core application concept and analytics page requirements
  - docs/architecture.md: Technical implementation patterns and component structure
---

# Analytics Implementation - Story 1.7

## Status
🔄 **PLANNING** - Planning and design

## Story

**As a** strategic user who has completed focus sessions and projects,
**I want** a comprehensive analytics dashboard that visualizes my productivity patterns and achievements,
**so that** I can understand my performance trends, celebrate progress, and optimize my strategic focus approach.

## Vision Statement

Create a **professional neo-brutalist Strava-inspired analytics dashboard** that transforms productivity data into compelling visual stories. The page combines bold creativity with corporate sophistication, using dark purple dominance and pink energy to create the "twilight productivity" aesthetic - where professional depth meets creative achievement celebration.

## Scope

Transform the placeholder Analytics page into a fully functional productivity dashboard featuring:
- Professional dark purple (#451969) and pink (#E5B6E5) color palette
- Creative data visualizations beyond traditional charts
- 2-week focused insights instead of overwhelming annual data
- Neo-brutalist design with bold shadows, thick borders, and geometric elements
- Strava-inspired progress tracking and achievement celebration

## Color Philosophy & Visual Strategy

### Primary Color Palette

```css
/* Analytics Neo-Brutalist Color System */
--analytics-dominant: #451969;      /* Dark Purple - Authority, depth, strategic insight */
--analytics-accent: #E5B6E5;        /* Pink - Achievement celebration, energy bursts */
--analytics-cream: #F5F5DC;         /* Cream - Clean data clarity, breathing space */
--analytics-black: #000000;         /* Black - Bold structure, emphasis, power */
--analytics-white: #FFFFFF;         /* White - Contrast, negative space */
```

### Color Storytelling
- **Purple Dominance**: Conveys professional mastery, strategic thinking, corporate authority
- **Pink Acceleration**: Celebrates achievements, shows momentum, energizes interactions
- **Side-by-Side Harmony**: Purple + pink create sophisticated energy without compromising professionalism
- **Black Structure**: Thick borders and shadows provide neo-brutalist geometric power
- **Cream Clarity**: Data backgrounds ensure readability while maintaining warmth

### Visual Hierarchy
1. **Hero Metrics** (Dark purple cards with pink accents)
2. **Interactive Visualizations** (Purple dominance with pink data highlights)
3. **Supporting Information** (Cream backgrounds with black typography)

## Acceptance Criteria

### Core Data Visualizations (Refined for Single-Screen Impact)
1. ✅ **Compact Stats Bar**: Today's sessions, weekly XP, current streak in horizontal strip (80px height)
2. ✅ **2-Week Intensity Grid**: Session frequency heatmap (14 days, GitHub-style)
3. ✅ **Strategic Completion Dots**: Cost/benefit scatter plot showing completed projects
4. ✅ **Focus Quality Metrics**: Weekly mindset breakdown (Shaolin/Getting There/What Zone?) with session counts
5. ✅ **Personal Records Cards**: 2×2 achievement display with subtle celebration

### Professional Neo-Brutalist Design (Refined)
6. ✅ Moderate black borders (2-3px for components, maintaining structure without aggression)
7. ✅ Softened drop shadows (4px 4px 0px at 40% opacity - visible but not overwhelming)
8. ✅ No rounded corners - geometric precision maintained
9. ✅ Professional typography (Inter Bold/Medium - strong but not chunky)
10. ✅ High contrast for accessibility while maintaining corporate appropriateness
11. ✅ Structured aesthetic with visual restraint and sophistication

### Single-Screen Experience Requirements
12. ✅ All core insights visible without scrolling (single viewport experience)
13. ✅ Corporate-appropriate visual weight and color usage
14. ✅ Strategic story clarity - focus on actionable insights over celebration
15. ✅ Desktop-optimized layout for 1200px+ screens
16. ✅ Fast loading times (<200ms for initial data)
17. ✅ Smooth, subtle animations at 60fps

### Technical Requirements
18. ✅ Server-side data fetching for initial metrics
19. ✅ Client components for interactive visualizations
20. ✅ Integration with existing Supabase sessions and projects tables (including mindset field)
21. ✅ TypeScript strict mode compliance
22. ✅ Error handling and loading states
23. ✅ Desktop-focused layout (mobile considerations deferred)

## Component Architecture

### Data Layer
```
src/lib/analytics/
├── queries.ts              # Supabase data queries
├── types.ts                # TypeScript interfaces
├── calculations.ts         # XP, streak, and metric calculations
└── constants.ts            # Chart configurations and thresholds
```

### Component Structure (Refined)
```
src/components/analytics/
├── CompactStatsBar.tsx     # Horizontal stats strip (Today/Week/Streak)
├── IntensityGrid.tsx       # 2-week session heatmap
├── CompletionDots.tsx      # Strategic cost/benefit scatter plot
├── FocusQuality.tsx        # Weekly mindset breakdown (high/medium/low)
├── PersonalRecords.tsx     # 2×2 achievement cards
└── types.ts               # Component-specific types
```

### Styling Architecture
```
src/styles/features/analytics/
├── index.css              # Main analytics theme
├── components.css         # Reusable component styles
├── animations.css         # Entrance and hover animations
└── responsive.css         # Mobile-responsive overrides
```

## Data Queries Specification

### Required Database Queries
1. **Recent Session Intensity**: 14-day session count and duration data
2. **Project Completion Treemap**: Completed projects grouped by category with XP totals
3. **Focus Distribution**: Session time allocation across active projects
4. **Radial Progress**: Daily commitment completion percentages
5. **Personal Bests**: Longest session, highest XP week, longest streak, most productive day
6. **Weekly Momentum**: 7-day session and XP trend data

### Example Query Structure
```sql
-- Recent Session Intensity (2 weeks)
SELECT
  DATE(started_at) as session_date,
  COUNT(*) as session_count,
  SUM(duration) as total_minutes,
  AVG(CASE WHEN is_completed THEN 1 ELSE 0 END) as completion_rate
FROM sessions
WHERE user_id = $1
  AND started_at >= NOW() - INTERVAL '14 days'
GROUP BY DATE(started_at)
ORDER BY session_date;
```

## Visual Concepts - Validation Stage Simplicity

**Core Philosophy**: Stunning visuals with simple data - focus on immediate impact over complex algorithms.

### 1. Hero Stats Cards (Big Numbers, Bold Impact)
- **Visual**: 3 massive cards with giant numbers
- **Colors**: Dark purple (#451969) backgrounds, pink (#E5B6E5) accent borders
- **Content**: Today's sessions, This week's XP, Current streak
- **Neo-Brutal**: 6px black borders, 10px shadows, no rounded corners
- **Simple Data**: Count sessions, sum XP, calculate streak days

### 2. Two-Week Focus Grid (GitHub-style Heatmap)
- **Visual**: 2×7 grid = 14 squares representing last 2 weeks
- **Colors**: Empty (cream) → 1 session (light purple) → many sessions (dark purple)
- **Neo-Brutal**: Each square has thick black border, hard edges
- **Simple Data**: Count daily completed sessions, map to color intensity
- **Hover**: Shows date and session count

### 3. Strategic Completion Dots (TacticalMap Mirror)
- **Visual**: 10×10 grid matching TacticalMap layout exactly
- **Dots**: Small circles positioned at cost×benefit coordinates
- **Colors**: Light purple (1 project) → Dark purple (5+ projects)
- **Simple Data**: Group completed projects by cost/benefit position, count per coordinate
- **Story**: Shows user's strategic patterns - do they complete high-benefit projects?


### 4. Project Focus Bars (Simple Bar Chart)
- **Visual**: Horizontal bars showing time per project (last 30 days)
- **Colors**: Each bar is purple with varying opacity based on category
- **Simple Data**: Sum session minutes per project
- **Neo-Brutal**: Thick black borders on bars, no gradients

### 5. Personal Bests (Trophy Cards)
- **Visual**: 4 achievement cards in 2×2 grid
- **Content**: Best day (most sessions), Best week (highest XP), Longest streak, Longest session
- **Colors**: Pink backgrounds, black text, dark purple accents
- **Simple Data**: Find max values in historical data

## Validation Stage Scope

**What We Build**:
- Visual impact that wows users
- Simple data queries (counts, sums, max values)
- Neo-brutalist styling that feels professional yet bold
- 5 core visualizations that tell the productivity story

**What We Skip (For Now)**:
- Complex algorithms (treemaps, force-directed layouts)
- Advanced interactivity (drill-downs, filters)
- Real-time updates
- Mobile-specific optimizations

**Success Metrics**:
- Users say "wow" when they see their analytics
- Page loads in under 2 seconds
- Data is accurate and motivating
- Visual design reinforces Eugene Strat brand

## Layout Specification (Single-Screen Experience)

### Desktop Web App Layout (1200px+ optimized, no scroll needed)
```
┌─────────────────────────────────────────────────────────┐
│  Header (Brand + XP + Menu)                            │
├─────────────────────────────────────────────────────────┤
│  Compact Stats Bar (Today | Week | Streak)             │
├─────────────────────────────┬───────────────────────────┤
│  Left Column (60%)          │  Right Column (40%)       │
│  ┌─────────────────────────┐ │  ┌───────────────────────┐ │
│  │ 2-Week Intensity Grid   │ │  │ Strategic Completion  │ │
│  │ (GitHub-style heatmap)  │ │  │ Dots (cost/benefit)   │ │
│  └─────────────────────────┘ │  └───────────────────────┘ │
│  ┌─────────────────────────┐ │  ┌───────────────────────┐ │
│  │ Focus Quality Metrics   │ │  │ Personal Bests        │ │
│  │ (weekly mindset counts) │ │  │ (2×2 achievement)     │ │
│  └─────────────────────────┘ │  └───────────────────────┘ │
├─────────────────────────────┴───────────────────────────┤
│  Navigation Grid (2×2 quadrant)                        │
└─────────────────────────────────────────────────────────┘
```

## Animation & Interaction Specifications

### Entrance Animations
- **Stagger**: Components appear with 100ms delay between each
- **Movement**: Slide up from 20px below with opacity fade-in
- **Duration**: 300ms ease-out curve

### Hover Interactions
- **Cards**: Transform translate(-2px, -2px) with shadow adjustment
- **Buttons**: Background color shift from purple to pink
- **Bubbles**: Scale transform (1.05x) with glow effect

### Data Updates
- **Counters**: Smooth counting animation over 1000ms
- **Progress**: Fill animations with easing curves
- **Charts**: Enter/exit animations for new data points

## Accessibility Requirements

### Color Contrast
- All text meets WCAG AA standards (4.5:1 minimum)
- Purple (#451969) on white: 9.8:1 ratio ✓
- Pink (#E5B6E5) on black: 4.7:1 ratio ✓
- White on purple: 9.8:1 ratio ✓

### Interaction
- All interactive elements have proper hover and focus states
- Keyboard navigation support for all components
- Screen reader friendly labels and ARIA attributes
- Focus indicators visible with high contrast outline

### Desktop Optimization
- Designed for mouse and keyboard interactions
- Hover states provide rich interactive feedback
- Optimized for desktop viewport sizes (1200px+)

## Testing Requirements

### Integration Tests
- [ ] Data fetching and display accuracy
- [ ] Chart rendering with various data sets
- [ ] Desktop layout integrity and spacing
- [ ] Animation performance (60fps requirement)

### Component Tests
- [ ] PulseStats calculations and display
- [ ] IntensityGrid color mapping and interactions
- [ ] RadialProgress percentage calculations
- [ ] Error handling for missing data

### Accessibility Tests
- [ ] Color contrast validation
- [ ] Keyboard navigation flow
- [ ] Screen reader compatibility
- [ ] Desktop mouse interaction testing

## Success Criteria

### Performance Benchmarks
1. **Initial Load**: Under 200ms for data fetching
2. **Animation Frame Rate**: Consistent 60fps during interactions
3. **Bundle Size**: Analytics components under 50KB gzipped
4. **Memory Usage**: No memory leaks during extended usage

### User Experience Goals
1. **Instant Comprehension**: Key metrics visible within 3 seconds
2. **Progressive Disclosure**: Detailed data available through interactions
3. **Motivational Impact**: Visual celebration of achievements and progress
4. **Professional Presentation**: Corporate-appropriate design that inspires confidence

### Technical Success Metrics
1. **Type Safety**: 100% TypeScript coverage with strict mode
2. **Error Handling**: Graceful fallbacks for all data states
3. **Desktop Optimization**: Perfect layout for desktop browsers (1200px+)
4. **Integration**: Seamless connection with existing Supabase schema

## Implementation Phases

### Phase 1: Foundation (Stories 1.7.1-1.7.3)
- Story documentation and data queries
- Neo-brutalist theme creation
- Hero stats cards implementation

### Phase 2: Core Visualizations (Stories 1.7.4-1.7.7)
- 2-week intensity grid
- Project completion treemap
- Radial progress wheel
- Focus distribution bubbles

### Phase 3: Polish & Integration (Stories 1.7.8-1.7.10)
- Personal records showcase
- Page assembly and responsive layout
- Loading states and error handling

### Phase 4: Testing & Optimization (Story 1.7.11)
- Performance optimization
- Accessibility validation
- Cross-browser testing
- Final polish and launch preparation

---

**Note**: This implementation creates the first true "Analytics" experience in Eugene Strat, transforming raw productivity data into an inspiring, professional dashboard that motivates continued strategic focus and achievement.

# Analytics Page Wireframe

## Color Palette & Visual Identity

```
🟣 DOMINANT: #451969    (Dark Purple) - Authority, depth, strategic mastery
🩷 ACCENT:   #E5B6E5    (Pink)        - Achievement, energy, celebration
🟫 CREAM:    #F5F5DC    (Cream)       - Data clarity, breathing space
⚫ BLACK:    #000000    (Black)       - Structure, borders, emphasis
⚪ WHITE:    #FFFFFF    (White)       - Contrast, negative space
```

## Page Layout - Single-Screen Desktop Experience

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ [🔹 Header: App Brand + XP Gauge + Hamburger Menu]                          │ 80px
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  COMPACT STATS BAR (Horizontal Strip)                                      │ 80px
│  [📊 3] Sessions Today  |  [⚡ 1,240] XP This Week  |  [🔥 7] Day Streak   │
│  Purple bg, white text, subtle borders (2px), no shadows                   │
│                                                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  LEFT COLUMN (60%)          │  RIGHT COLUMN (40%)                          │
│  ┌─────────────────────────┐ │  ┌───────────────────────────────────────┐   │
│  │ 2-WEEK INTENSITY GRID   │ │  │ STRATEGIC COMPLETION DOTS             │   │ 180px
│  │ ┌─┬─┬─┬─┬─┬─┬─┐          │ │  │  10│        ●                        │   │
│  │ │🟫│🟣│🟫│🩷│🟣│🟫│🩷│     │ │  │   8│    ●       ●●                  │   │
│  │ ├─┼─┼─┼─┼─┼─┼─┤          │ │  │   6│●           ●                     │   │
│  │ │🟣│🟣│🟫│🩷│🟣│🟣│🟫│     │ │  │   4│        ●                       │   │
│  │ └─┴─┴─┴─┴─┴─┴─┘          │ │  │   2│                                 │   │
│  │ GitHub-style heatmap     │ │  │    └─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─              │   │
│  └─────────────────────────┘ │  │     2 4 6 8 10 COST                   │   │
│                              │  │  Purple intensity by project count     │   │
│  ┌─────────────────────────┐ │  └───────────────────────────────────────┘   │
│  │ FOCUS QUALITY METRICS   │ │                                              │
│  │ (This Week - 12 Sessions)│ │  ┌───────────────────────────────────────┐   │ 180px
│  │ Shaolin Mode     8      │ │  │ PERSONAL BESTS (2×2 Grid)             │   │
│  │ Getting There    3      │ │  │ ┌─────────┬─────────────────────────┐ │   │
│  │ What Zone?       1      │ │  │ │BEST DAY │ LONGEST STREAK          │ │   │
│  │ Simple counts, no %     │ │  │ │<Trophy> │ <Flame> [12] Days      │ │   │
│  └─────────────────────────┘ │  │ │   [5]   │                       │ │   │
│                              │  │ ├─────────┼─────────────────────────┤ │   │
│                              │  │ │BEST WEEK│ LONGEST SESSION         │ │   │
│                              │  │ │<Zap>    │ <Clock> [2.5h]          │ │   │
│                              │  │ │[2,840]XP│                       │ │   │
│                              │  │ └─────────┴─────────────────────────┘ │   │
│                              │  │ Pink bg, black text, soft shadows     │   │
│                              │  └───────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────────────────────┤
│ [🔹 Fixed Navigation Grid: 2x2 quadrant - bottom right]                     │ 60px
└─────────────────────────────────────────────────────────────────────────────┘
Total Height: ~600px (fits in single viewport)
```


## Component Specifications

### 1. Compact Stats Bar

```
Horizontal Strip Layout (full width × 80px):

┌─────────────────────────────────────────────────────────────────────────────┐
│ [📊 3] Sessions Today  |  [⚡ 1,240] XP This Week  |  [🔥 7] Day Streak     │
│ Purple background #451969, white text (16px Inter Medium)                   │
│ Subtle borders (2px), no shadows, clean separation                          │
└─────────────────────────────────────────────────────────────────────────────┘
Background: Dark Purple (#451969)
Text: White (#FFFFFF), 16px Inter Medium
Borders: 2px solid black
Height: 80px (compact)
```

### 2. Two-Week Focus Grid

```
Grid Layout (280px × 120px):

S  M  T  W  T  F  S    ← Day labels (12px)
┌─┬─┬─┬─┬─┬─┬─┐
│🟫│🟣│🟫│🩷│🟣│🟫│🩷│   ← Week 1 (each cell: 35px × 35px)
├─┼─┼─┼─┼─┼─┼─┤
│🟣│🟣│🟫│🩷│🟣│🟣│🟫│   ← Week 2
└─┴─┴─┴─┴─┴─┴─┘

Colors:
🟫 Cream #F5F5DC     (0 sessions)
🟣 Light Purple      (1 session)
🩷 Pink #E5B6E5      (2 sessions)
🟣 Dark Purple       (3+ sessions)

Borders: 4px black between cells
Hover: Shows "Mon, Dec 4 - 2 sessions, 3.5 hours"
```

### 3. Strategic Completion Dots

```
10×10 Grid (400px × 400px):

BENEFIT
   10 ┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐
    9 ├─┼─┼─┼─┼─┼─┼─┼●┼─┼─┤  ● Dark Purple (3+ projects)
    8 ├─┼─┼─┼●┼─┼─┼●┼●┼─┼─┤  ◐ Medium Purple (2 projects)
    7 ├─┼─┼─┼─┼─┼─┼●┼─┼─┼─┤  ○ Light Purple (1 project)
    6 ├●┼─┼─┼─┼─┼─┼●┼─┼─┼─┤
    5 ├─┼─┼●┼─┼─┼─┼─┼─┼─┼─┤
    4 ├─┼─┼─┼─┼●┼─┼─┼─┼─┼─┤
    3 ├─┼─┼─┼─┼─┼─┼─┼─┼─┼─┤
    2 ├─┼─┼─┼─┼─┼─┼─┼─┼─┼─┤
    1 └─┴─┴─┴─┴─┴─┴─┴─┴─┴─┘
      1 2 3 4 5 6 7 8 9 10 COST

Dot Sizes: 8px (1 project), 12px (2-3), 16px (4+)
Grid: 1px gray lines, 2px black border
Hover: "Cost 8, Benefit 9 - 2 projects completed"
```

### 4. Personal Bests Cards (Refined)

```
2×2 Grid Layout (Subtle Design):

┌─────────────┬─────────────┐
│   BEST DAY  │  LONGEST    │ ← Pink background #E5B6E5
│ <Trophy> [5]│   STREAK    │ ← Lucide icon + number (20px, black)
│  Sessions   │<Flame> [12] │ ← Label (12px, black)
│             │    Days     │
├─────────────┼─────────────┤
│  BEST WEEK  │  LONGEST    │
│<Zap> [2,840]│  SESSION    │
│     XP      │<Clock> [2.5h│
│             │             │
└─────────────┴─────────────┘

Each card: 140px × 120px
Borders: 2px black (refined)
Shadow: 4px 4px 0px #000000 at 40% opacity (soft)
Typography: Inter Medium numbers, Inter Regular labels
```

### 5. Focus Quality Metrics

```
Weekly Mindset Breakdown (300px wide × 120px tall):

FOCUS QUALITY (This Week - 12 Sessions)
┌─────────────────────────────────┐
│ Shaolin Mode     8              │ ← High mindset sessions
│ Getting There    3              │ ← Medium mindset sessions
│ What Zone?       1              │ ← Low mindset sessions
└─────────────────────────────────┘

Background: Cream #F5F5DC
Text: Purple #451969, 14px Inter Medium
Labels: 12px Inter Regular
Numbers: Right-aligned, 14px Inter Medium
Borders: 2px black outline
```

## Neo-Brutalist Design System

### Borders & Shadows (Professional Restraint)
```
Large Components:  2-3px solid black border, 4px 4px 0px black shadow at 40% opacity
Medium Components: 2px solid black border, 3px 3px 0px black shadow at 40% opacity
Small Elements:    1px solid black border, 2px 2px 0px black shadow at 30% opacity

No rounded corners (geometric precision maintained)
Shadows are hard (no blur) but reduced opacity for sophistication
```

### Typography (Refined Professional)
```
Stats Numbers:   20px, Inter Medium, #FFFFFF on purple (reduced from 48px)
Section Headers: 18px, Inter Bold, #000000 (reduced from 24px)
Labels:          14px, Inter Medium, #000000
Small Text:      12px, Inter Regular, #666666
Icon Numbers:    16px, Inter Medium (achievement cards)
```

### Spacing
```
Page margins:     24px
Component gaps:   16px
Card padding:     20px
Grid spacing:     8px
```

### Interactions (Subtle)
```
Hover: transform: translate(-1px, -1px) + slight shadow reduction (gentle)
Click: transform: translate(1px, 1px) + shadow reduction
Focus: 2px solid purple outline (professional, not pink)
Transitions: 200ms ease-out (smooth, not jarring)
```

## Data Requirements (Simple Queries)

### Today's Stats
- Count completed sessions where date = today
- Sum XP from today's sessions

### Weekly Stats
- Count completed sessions this week (Sunday-Saturday)
- Sum XP from this week's sessions

### Streak Calculation
- Count consecutive days with at least 1 completed session
- Break if gap > 1 day

### Two-Week Grid
- Daily session counts for last 14 days
- Map to color intensity (0=cream, 1=light purple, 2=pink, 3+=dark purple)

### Completion Dots
- Group completed projects by cost×benefit coordinates
- Count projects per position
- Map count to dot size and color intensity

### Personal Bests
- MAX(daily_sessions) = Best Day
- MAX(weekly_xp) = Best Week
- MAX(streak_length) = Longest Streak
- MAX(session_duration) = Longest Session

### Focus Quality (This Week)
- Count sessions by mindset: 'high', 'medium', 'low' from sessions table
- Total completed sessions this week for header
- Simple queries using existing mindset field from DeepFocus

## Success Criteria (Refined)

🎯 **Strategic Clarity**: Users immediately understand their productivity patterns and strategic focus
⚡ **Performance**: Page loads under 2 seconds with smooth, subtle animations
🖥️ **Single-Screen Experience**: All core insights visible without scrolling (fits ~600px viewport)
📊 **Actionable Insights**: Data presentation drives strategic decisions, not just celebration
🏢 **Professional**: Sophisticated design appropriate for corporate environments
🔍 **Immediate Comprehension**: Key metrics clear within 3 seconds of page load